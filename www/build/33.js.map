{"version":3,"sources":["../../src/pages/permissions/permissions-screen.module.ts","../../src/pages/permissions/permissions-screen.ts"],"names":[],"mappings":"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","file":"33.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { PermissionsModalPage } from \"./permissions-screen\";\r\n\r\n\r\n@NgModule({\r\n    declarations: [\r\n        PermissionsModalPage,\r\n    ],\r\n    imports: [\r\n        IonicPageModule.forChild(PermissionsModalPage),\r\n    ],\r\n})\r\n\r\nexport class PermissionsModalPageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/permissions/permissions-screen.module.ts","import { Component } from '@angular/core';\r\nimport { AndroidPermissions } from '@ionic-native/android-permissions';\r\nimport { ViewController, IonicPage, NavParams, AlertController } from 'ionic-angular';\r\n\r\nimport { User } from '../../models/user'\r\n\r\nimport { UserProvider } from '../../providers/user/user';\r\n\r\n@IonicPage()\r\n@Component({\r\n    selector: 'permissions-screen',\r\n    templateUrl: 'permissions-screen.html'\r\n})\r\nexport class PermissionsModalPage {\r\n\r\n    user_id: any;\r\n    user: any;\r\n    fromPage: string = '';\r\n    public title: string = '';\r\n    public reason: string = '';\r\n\r\n\r\n\r\n    constructor(\r\n        private navParams: NavParams,\r\n        public alertCtrl: AlertController,\r\n        private userProvider: UserProvider,\r\n        private androidPermissions: AndroidPermissions,\r\n        private viewCtrl: ViewController\r\n    ) { }\r\n\r\n    ionViewWillLoad() {\r\n        this.getPage()\r\n    }\r\n\r\n    ionViewCanEnter() {\r\n        this.userProvider.getUserLocal().then(userID => {\r\n            if (userID) {\r\n                this.user_id = userID;\r\n                this.userProvider.byId(userID)\r\n                    .subscribe((user: User) => {\r\n                        this.user = user;\r\n                    })\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    // PROCURAR AQUI PARA DIVIDER CADA PERMISSÃO EM UMA TELA SEPARADA\r\n    getPage() {\r\n        const IMEI = `O Zona Fácil precisará do seu IMEI para prosseguir. O IMEI é o identificador único do seu smartphone e ele garantirá a segurança das suas transações.`;\r\n        const localização = `O Zona Fácil está à sua disposição em muitos bairros, e para melhor atendê-lo, gostaríamos da sua permissão para acessar a sua localização para selecionar automaticamente o bairro onde você está localizado e para informar vagas disponíveis, nos bairros onde há este serviço.`;\r\n        const camera = `O Zona Fácil precisará acessar sua câmera ou arquivos de mídia para prosseguir. Isso porque será necessário enviar uma foto do documento.`;\r\n\r\n        return new Promise(resolve => {\r\n            this.fromPage = this.navParams.get('fromPage');\r\n\r\n            if (this.fromPage == 'profile-edit') {\r\n                this.title = 'Acesso a Câmera e Galeria!'\r\n                this.reason = 'O Zona Fácil precisa de acesso a camera e a galeria para alterar a foto de perfil!'\r\n            } else if (this.fromPage === 'phone') {\r\n                this.title = 'Acesso ao Telefone';\r\n                this.reason = IMEI;\r\n            } else if (this.fromPage === 'pdv-empresa') {\r\n                this.title = 'Acesso a Câmera e Galeria!'\r\n                this.reason = camera;\r\n            } else {\r\n                this.title = 'Acesso a Localização!';\r\n                this.reason = localização;\r\n            }\r\n            resolve(true)\r\n        }\r\n        )\r\n    }\r\n\r\n    askPermissions() {\r\n        if (this.fromPage == 'profile-edit' || this.fromPage == 'pdv-empresa') {\r\n            this.askCameraPermission()\r\n        } else if (this.fromPage == 'phone') {\r\n            this.askPhonePermision()\r\n        } else {\r\n            this.askLocationPermission()\r\n        }\r\n    }\r\n\r\n\r\n    askCameraPermission() {\r\n        this.androidPermissions.requestPermissions([\r\n            this.androidPermissions.PERMISSION.CAMERA,\r\n            this.androidPermissions.PERMISSION.WRITE_EXTERNAL_STORAGE\r\n        ])\r\n            .then(() => {\r\n                this.closePage()\r\n            })\r\n            .catch((error) => {\r\n            })\r\n    }\r\n\r\n    askPhonePermision() {\r\n        this.androidPermissions.requestPermission(this.androidPermissions.PERMISSION.READ_PHONE_STATE)\r\n            .then((result) => {\r\n                if (result.hasPermission) {\r\n                    this.userProvider.updateUuidOrImei(this.user_id, (uuid) => {\r\n                        this.user.uidAparelho = uuid;\r\n                    });\r\n                    this.closePage();\r\n                } else {\r\n                    this.androidPermissions.checkPermission(this.androidPermissions.PERMISSION.READ_PHONE_STATE)\r\n                        .then((result) => {\r\n                            if (result.hasPermission) {\r\n                                this.closePage()\r\n                            } else {\r\n                                this.showAlert('Permissão Importante!', 'O Zona Fácil precisa de acesso ao Telefone, para obter o IMEI do dispositivo para o funcionamento do sistema.', 'alert-button-group')\r\n                            }\r\n                        })\r\n                        .catch((error) => {\r\n                        })\r\n                }\r\n            })\r\n    }\r\n\r\n    askLocationPermission() {\r\n        this.androidPermissions.requestPermission(\r\n            this.androidPermissions.PERMISSION.ACCESS_FINE_LOCATION)\r\n            .then((result) => {\r\n                this.closePage();\r\n            })\r\n            .catch(err => console.log(err));\r\n    }\r\n\r\n\r\n    askPhonePermission() {\r\n        this.androidPermissions.requestPermission(this.androidPermissions.PERMISSION.READ_PHONE_STATE)\r\n            .then(result => {\r\n                if (result.hasPermission) {\r\n                    this.userProvider.updateUuidOrImei(this.user_id, (uuid) => {\r\n                    })\r\n                    this.closePage();\r\n                }\r\n            }\r\n            )\r\n    }\r\n    \r\n    closePage() {\r\n        this.viewCtrl.dismiss()\r\n    }\r\n\r\n    showAlert(title: string, msg: string, type: string) {\r\n        this.alertCtrl.create({\r\n            title: title,\r\n            message: msg,\r\n            cssClass: type,\r\n            buttons: [\r\n                {\r\n                    text: 'Autorizar',\r\n                    cssClass: 'btn-ok',\r\n                    handler: () => {\r\n                        this.askPhonePermission()\r\n                    }\r\n                },\r\n                {\r\n                    text: 'Cancelar',\r\n                    cssClass: 'btn-warning',\r\n                    handler: () => {\r\n                        this.closePage()\r\n                    }\r\n                }\r\n            ]\r\n        }).present();\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/permissions/permissions-screen.ts"],"sourceRoot":""}